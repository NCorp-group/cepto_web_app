{"remainingRequest":"/home/jens/repos/cepto_web_app/node_modules/babel-loader/lib/index.js!/home/jens/repos/cepto_web_app/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/home/jens/repos/cepto_web_app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/jens/repos/cepto_web_app/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/home/jens/repos/cepto_web_app/src/components/Table.vue?vue&type=template&id=783f90ce","dependencies":[{"path":"/home/jens/repos/cepto_web_app/src/components/Table.vue","mtime":1620580529840},{"path":"/home/jens/repos/cepto_web_app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jens/repos/cepto_web_app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/jens/repos/cepto_web_app/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1616796459000},{"path":"/home/jens/repos/cepto_web_app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jens/repos/cepto_web_app/node_modules/vue-loader-v16/dist/index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCByZW5kZXJMaXN0IGFzIF9yZW5kZXJMaXN0LCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVCbG9jayBhcyBfY3JlYXRlQmxvY2ssIHRvRGlzcGxheVN0cmluZyBhcyBfdG9EaXNwbGF5U3RyaW5nIH0gZnJvbSAidnVlIjsKdmFyIF9ob2lzdGVkXzEgPSB7CiAgaWQ6ICJ0YWJsZSIsCiAgY2xhc3M6ICJjb250YWluZXIiCn07Cgp2YXIgX2hvaXN0ZWRfMiA9IC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoImgxIiwgbnVsbCwgIlBhdGllbnQgTmFtZSIsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF8zID0gLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgiaDQiLCBudWxsLCAiRXZlbnQgTG9ncyIsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF80ID0gewogIGNsYXNzOiAidGFibGUgbXQtNSIKfTsKCnZhciBfaG9pc3RlZF81ID0gLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgidGhlYWQiLCBudWxsLCBbLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgidHIiLCBudWxsLCBbLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgidGgiLCB7CiAgc2NvcGU6ICJjb2wiCn0sICJWaXNpdElEIiksIC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoInRoIiwgewogIHNjb3BlOiAiY29sIgp9LCAiRXZlbnRJRCIpLCAvKiNfX1BVUkVfXyovX2NyZWF0ZVZOb2RlKCJ0aCIsIHsKICBzY29wZTogImNvbCIKfSwgIkV2ZW50IFR5cGUiKSwgLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgidGgiLCB7CiAgc2NvcGU6ICJjb2wiCn0sICJEYXRlIiksIC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoInRoIiwgewogIHNjb3BlOiAiY29sIgp9LCAiVGltZXN0YW1wIiksIC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoInRoIiwgewogIHNjb3BlOiAiY29sIgp9LCAiVGltZSBzaW5jZSBsYXN0IGV2ZW50IildKV0sIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF82ID0gewogIHNjb3BlOiAicm93Igp9Owp2YXIgX2hvaXN0ZWRfNyA9IHsKICBzY29wZTogInJvdyIKfTsKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzEsIFtfaG9pc3RlZF8yLCBfaG9pc3RlZF8zLCBfY3JlYXRlVk5vZGUoImJ1dHRvbiIsIHsKICAgIHR5cGU6ICJidXR0b24iLAogICAgb25DbGljazogX2NhY2hlWzFdIHx8IChfY2FjaGVbMV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkb3B0aW9ucy5vbl9yZWZyZXNoICYmICRvcHRpb25zLm9uX3JlZnJlc2guYXBwbHkoJG9wdGlvbnMsIGFyZ3VtZW50cyk7CiAgICB9KSwKICAgIGNsYXNzOiAiYnRuIGJ0bi1kYXJrIgogIH0sICIgUmVmcmVzaCAiKSwgX2NyZWF0ZVZOb2RlKCJidXR0b24iLCB7CiAgICB0eXBlOiAiYnV0dG9uIiwKICAgIG9uQ2xpY2s6IF9jYWNoZVsyXSB8fCAoX2NhY2hlWzJdID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJG9wdGlvbnMub25fbG9nICYmICRvcHRpb25zLm9uX2xvZy5hcHBseSgkb3B0aW9ucywgYXJndW1lbnRzKTsKICAgIH0pLAogICAgY2xhc3M6ICJidG4gYnRuLWRhcmsiCiAgfSwgIiBQcmludCBBUEkgZGF0YSAiKSwgX2NyZWF0ZVZOb2RlKCJ0YWJsZSIsIF9ob2lzdGVkXzQsIFtfaG9pc3RlZF81LCBfY3JlYXRlVk5vZGUoInRib2R5IiwgbnVsbCwgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlQmxvY2soX0ZyYWdtZW50LCBudWxsLCBfcmVuZGVyTGlzdChfY3R4LnZpc2l0cywgZnVuY3Rpb24gKHZpc2l0LCBpKSB7CiAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soInRyIiwgewogICAgICBrZXk6IGkKICAgIH0sIFtfY3JlYXRlVk5vZGUoInRoIiwgX2hvaXN0ZWRfNiwgX3RvRGlzcGxheVN0cmluZyhfY3R4LnZpc2l0cy5sZW5ndGggLSBpKyspLCAxCiAgICAvKiBURVhUICovCiAgICApLCBfY3JlYXRlVk5vZGUoInRib2R5IiwgbnVsbCwgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlQmxvY2soX0ZyYWdtZW50LCBudWxsLCBfcmVuZGVyTGlzdChfY3R4LnZpc2l0c1tpXS5ldmVudHMsIGZ1bmN0aW9uIChldmVudCwgaikgewogICAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soInRyIiwgewogICAgICAgIGtleTogagogICAgICB9LCBbX2NyZWF0ZVZOb2RlKCJ0aCIsIF9ob2lzdGVkXzcsIF90b0Rpc3BsYXlTdHJpbmcoX2N0eC52aXNpdHNbaV0uZXZlbnRzLmxlbmd0aCAtIGkrKyksIDEKICAgICAgLyogVEVYVCAqLwogICAgICApLCBfY3JlYXRlVk5vZGUoInRkIiwgbnVsbCwgX3RvRGlzcGxheVN0cmluZyhldmVudC50eXBlKSwgMQogICAgICAvKiBURVhUICovCiAgICAgICksIF9jcmVhdGVWTm9kZSgidGQiLCBudWxsLCBfdG9EaXNwbGF5U3RyaW5nKGV2ZW50LmRhdGV0aW1lLnRvTG9jYWxlRGF0ZVN0cmluZygnZGEtREsnKSksIDEKICAgICAgLyogVEVYVCAqLwogICAgICApLCBfY3JlYXRlVk5vZGUoInRkIiwgbnVsbCwgX3RvRGlzcGxheVN0cmluZyhldmVudC5kYXRldGltZS50b0xvY2FsZURhdGVTdHJpbmcoJ2RhLURLJykpLCAxCiAgICAgIC8qIFRFWFQgKi8KICAgICAgKSwgX2NyZWF0ZVZOb2RlKCJ0ZCIsIG51bGwsIF90b0Rpc3BsYXlTdHJpbmcoZXZlbnQudGltZV9zaW5jZV9sYXN0KSwgMQogICAgICAvKiBURVhUICovCiAgICAgICldKTsKICAgIH0pLCAxMjgKICAgIC8qIEtFWUVEX0ZSQUdNRU5UICovCiAgICApKV0pXSk7CiAgfSksIDEyOAogIC8qIEtFWUVEX0ZSQUdNRU5UICovCiAgKSldKV0pXSk7Cn0="},{"version":3,"sources":["/home/jens/repos/cepto_web_app/src/components/Table.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"table\" class=\"container\">\n    <h1>Patient Name</h1>\n    <h4>Event Logs</h4>\n    <button type=\"button\" @click=\"on_refresh\" class=\"btn btn-dark\">\n      Refresh\n    </button>\n    <button type=\"button\" @click=\"on_log\" class=\"btn btn-dark\">\n      Print API data\n    </button>\n    <table class=\"table mt-5\">\n      <thead>\n        <tr>\n          <th scope=\"col\">VisitID</th>\n          <th scope=\"col\">EventID</th>\n          <th scope=\"col\">Event Type</th>\n          <th scope=\"col\">Date</th>\n          <th scope=\"col\">Timestamp</th>\n          <th scope=\"col\">Time since last event</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"(visit, i) in visits\" :key=\"i\">\n          <th scope=\"row\">{{ visits.length - i++ }}</th>\n          <tbody>\n            <tr v-for=\"(event, j) in visits[i].events\" :key=\"j\">\n              <th scope=\"row\">{{ visits[i].events.length - i++ }}</th>\n              <td>{{ event.type }}</td>\n              <td>{{ event.datetime.toLocaleDateString('da-DK') }}</td>\n              <td>{{ event.datetime.toLocaleDateString('da-DK') }}</td>\n              <td>{{ event.time_since_last }}</td>\n            </tr>\n          </tbody>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\n//import Visit from 'visit.js'\n//import Event from 'event.js'\n\nclass Visit {\n  constructor(state, visit_id, datetime, desc, duration, events) {\n      this.state = state;\n      this.visit_id = visit_id;\n      this.datetime = datetime;\n      this.desc = desc;\n      this.duration = duration;\n      this.events = events;\n  }\n}\n\nclass Event {\n  constructor(type, datetime, time_since_last) {\n      this.type = type;\n      this.datetime = datetime;\n      this.time_since_last = time_since_last;\n  }\n}\n\nexport default {\n  name: \"event-table\",\n  data: () => ({ visits: [], api_data: null }),\n  methods: {\n    on_log() {\n      console.log(this.api_data);\n    },\n    on_refresh() {\n      //this.clear_logs();\n      this.fetch_logs();\n      this.process_api_data();\n    },\n    clear_logs() {\n      this.visits = [];\n    },\n    fetch_logs() {\n      axios.get('https://localhost:5001/FetchEvents/%7B%22session_token%22:%22601bc973-da4d-47cc-b3eb-4eb7c921bc48%22%7D')\n        .then(response => this.api_data = response.data.events)\n        .catch(error => console.log(error));\n    },\n    process_api_data() {\n      // NEW IMPLEMENTATION\n\n      for (let i = 0; i < this.api_data.length; i++) {\n        var last_event = null;\n        var events = null;\n\n        while (last_event.visit_id === current_event.visit_id || i == 0) {\n\n          var current_date = new Date(this.api_data[i].time);\n          var current_since_last = new Date(this.api_data[i].time_since_last);\n\n          var current_event = Event(\n            this.api_data[i].event_type,\n            current_date,\n            current_since_last.getMinutes()\n          );\n\n          events.unshift(current_event);\n\n          last_event = current_event;\n\n          i++;\n        }\n\n        var state = \"\";\n        if (events.length < 4) {\n          state = \"incomplete\";\n        }\n        else if (events.length == 4) {\n          state = \"complete\";\n        }\n        else if (this.api_data.length === i && this.api_data[i].event_type !== \"arrived_at_bed\") {\n          state = \"in_progress\";\n        }\n        else {\n          console.log(\"More than 4 events in visit\");\n        }\n\n        var duration = events[1].datetime.getTime() - events[events.length].datetime.getTime();\n        var duration_date = new Date(duration);\n        var duration_minutes = duration_date.getTime() / 1000 / 60;\n\n        var current_visit = new Visit(\n          state,\n          events[0].visit_id,\n          events[0].date,\n          state,\n          duration_minutes,\n          events\n        );\n\n        this.visits.unshift(current_visit);\n\n        events = [];\n      }\n\n      /*\n      for (let i = 0; i < this.api_data.length; i++) {\n        // Initialisation\n        var last_event = null;\n        if (i > 0) {\n          last_event = this.api_data[i-1];\n        }\n        var current_event = this.api_data[i];\n\n        // Per visit loop\n        var current_visit = [];\n        while (current_event.visit_id !== last_event.visit_id) {\n          \n        }\n      }\n      */\n      \n      /*\n      // var current_visit_id = 0;\n      for (let i = 0; i < this.api_data.length; i++) {\n        // Initialisation\n        var last_event = null;\n        if (i > 0) {\n          last_event = this.api_data[i-1];\n        }\n        var current_event = this.api_data[i];\n\n        // if (current_event.visit_id !== last_event.visit_id) {\n        //   current_visit_id++;\n        // }\n\n        // Processing\n        var current_event_type = current_event.event_type;\n        //console.log(new_event_type);\n\n        // first timestamp\n        // for absolute date and time\n        var current_date_str = current_event.time;\n        var date_obj = new Date(current_date_str);\n        //console.log(\"This is the date: \" + date_obj.toLocaleDateString('da-DK'));\n\n        var current_date = date_obj.toLocaleDateString('da-DK');\n        //console.log(new_date);\n\n        var current_timestamp = date_obj.toLocaleTimeString('da-DK');\n        //console.log(new_timestamp);\n\n        // second timestamp\n        // for the relative time since last event\n        // ACTUAL CODE var since_last_date_str = current_event.time;\n        // ACTUAL CODE var since_last_date_obj = new Date(since_last_date_str);\n        //console.log(\"Since last time: \" + since_last_date_obj);\n\n        // compute time since last event.\n        \n        // last timestamp\n        // for relative time later\n        \n        var current_time_since_last_event = \"-\";\n        if (i > 0) {\n          var last_date_obj = new Date(last_event.time);\n          //console.log(last_date_obj.getMinutes());\n          // ACTUAL CODE\n          // new_time_since_last_event = date_obj.getMinutes() - last_date_obj.getMinutes();\n          //TEST CODE\n          current_time_since_last_event = last_date_obj.getMinutes();\n        }\n        //console.log(new_time_since_last_event);\n\n        this.events.unshift({\n          event_type: current_event_type,\n          date: current_date,\n          timestamp: current_timestamp,\n          time_since_last_event: current_time_since_last_event\n        });\n      }\n      */\n    }\n  },\n  momunted() {\n    console.log(\"I AM HERE\");\n    this.fetch_logs();\n    console.log(this.api_data);\n    //this.process_api_data();\n  },\n};\n</script>\n\n<style>\n#table {\n  height: 100%;\n  flex-grow: 2;\n  padding: 0px 200px;\n  text-align: left;\n  color: #F6F6F6;\n  position: absolute;\n  margin-left: 200px;\n}\nbutton {\n  margin: 30px 10px 20px 0px;\n  padding: 10px 15px;\n  border-style: none;\n}\ntable > td {\n  padding: 5px;\n}\n</style>"],"sourceRoot":""}]}